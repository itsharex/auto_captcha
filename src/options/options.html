<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Captcha Solver - 设置</title>
    <link rel="stylesheet" href="options.css">
</head>

<body>
    <div class="options-container">
        <!-- 侧边栏 -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7L12 12L22 7L12 2Z" />
                    <path d="M2 17L12 22L22 17" />
                    <path d="M2 12L12 17L22 12" />
                </svg>
                <h1>AI Captcha Solver</h1>
            </div>

            <nav class="sidebar-nav">
                <a href="#api-config" class="nav-item active" data-section="api-config">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                    </svg>
                    <span>API 配置</span>
                </a>
                <a href="#settings" class="nav-item" data-section="settings">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3" />
                        <path
                            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" />
                    </svg>
                    <span>识别设置</span>
                </a>
                <a href="#history" class="nav-item" data-section="history">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <polyline points="12 6 12 12 16 14" />
                    </svg>
                    <span>历史记录</span>
                </a>
                <a href="#stats" class="nav-item" data-section="stats">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="20" x2="18" y2="10" />
                        <line x1="12" y1="20" x2="12" y2="4" />
                        <line x1="6" y1="20" x2="6" y2="14" />
                    </svg>
                    <span>统计数据</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <span class="version">v1.0.0</span>
            </div>
        </aside>

        <!-- 主内容区 -->
        <main class="main-content">
            <!-- API配置 -->
            <section id="api-config" class="section active">
                <div class="section-header">
                    <h2>API 配置</h2>
                    <p>管理您的AI模型API配置</p>
                </div>

                <div class="card">
                    <h3>快速添加</h3>
                    <div class="preset-grid">
                        <button class="preset-btn" data-preset="openai">
                            <div class="preset-icon openai">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path
                                        d="M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.8956zm16.5963 3.8558L13.1038 8.364 15.1192 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.4043-.6813zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z" />
                                </svg>
                            </div>
                            <span>OpenAI</span>
                        </button>
                        <button class="preset-btn" data-preset="claude">
                            <div class="preset-icon claude">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path
                                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z" />
                                </svg>
                            </div>
                            <span>Claude</span>
                        </button>
                        <button class="preset-btn" data-preset="gemini">
                            <div class="preset-icon gemini">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
                                </svg>
                            </div>
                            <span>Gemini</span>
                        </button>
                        <button class="preset-btn" data-preset="custom_openai">
                            <div class="preset-icon custom">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19" />
                                    <line x1="5" y1="12" x2="19" y2="12" />
                                </svg>
                            </div>
                            <span>自定义</span>
                        </button>
                    </div>
                </div>

                <!-- 配置列表 -->
                <div class="card">
                    <div class="card-header">
                        <h3>已保存的配置</h3>
                    </div>
                    <div id="config-list" class="config-list">
                        <div class="empty-state">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5">
                                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                            </svg>
                            <p>暂无配置</p>
                            <span>点击上方按钮添加API配置</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 识别设置 -->
            <section id="settings" class="section">
                <div class="section-header">
                    <h2>识别设置</h2>
                    <p>自定义验证码识别行为</p>
                </div>

                <div class="card">
                    <h3>请求设置</h3>
                    <div class="form-group">
                        <label for="timeout">超时时间 (秒)</label>
                        <input type="number" id="timeout" min="5" max="120" value="30">
                        <span class="hint">API请求的最大等待时间</span>
                    </div>
                    <div class="form-group">
                        <label for="retry-count">重试次数</label>
                        <input type="number" id="retry-count" min="1" max="5" value="3">
                        <span class="hint">识别失败时的重试次数</span>
                    </div>
                </div>

                <div class="card">
                    <h3>自动填充</h3>
                    <div class="form-group switch-group">
                        <div class="switch-label">
                            <label for="auto-fill">启用自动填充</label>
                            <span class="hint">识别成功后自动填充到输入框</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="auto-fill" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="form-group switch-group">
                        <div class="switch-label">
                            <label for="auto-submit">自动提交表单</label>
                            <span class="hint">填充后自动提交表单（谨慎使用）</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="auto-submit">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="card">
                    <h3>其他设置</h3>
                    <div class="form-group">
                        <label for="history-retention">历史记录保留天数</label>
                        <input type="number" id="history-retention" min="1" max="30" value="7">
                    </div>
                    <div class="form-group switch-group">
                        <div class="switch-label">
                            <label for="debug-mode">调试模式</label>
                            <span class="hint">在控制台输出详细日志</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="debug-mode">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="action-bar">
                    <button id="btn-save-settings" class="btn btn-primary">保存设置</button>
                </div>
            </section>

            <!-- 历史记录 -->
            <section id="history" class="section">
                <div class="section-header">
                    <h2>历史记录</h2>
                    <p>查看验证码识别历史</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>最近识别</h3>
                        <button id="btn-clear-history" class="btn btn-text">清空历史</button>
                    </div>
                    <div id="history-list" class="history-list">
                        <div class="empty-state">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5">
                                <circle cx="12" cy="12" r="10" />
                                <polyline points="12 6 12 12 16 14" />
                            </svg>
                            <p>暂无记录</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 统计数据 -->
            <section id="stats" class="section">
                <div class="section-header">
                    <h2>统计数据</h2>
                    <p>查看使用统计信息</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />
                            </svg>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value" id="stat-total">0</span>
                            <span class="stat-label">总识别次数</span>
                        </div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                                <polyline points="22 4 12 14.01 9 11.01" />
                            </svg>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value" id="stat-success">0</span>
                            <span class="stat-label">成功次数</span>
                        </div>
                    </div>
                    <div class="stat-card error">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="10" />
                                <line x1="15" y1="9" x2="9" y2="15" />
                                <line x1="9" y1="9" x2="15" y2="15" />
                            </svg>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value" id="stat-fail">0</span>
                            <span class="stat-label">失败次数</span>
                        </div>
                    </div>
                    <div class="stat-card info">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="10" />
                                <polyline points="12 6 12 12 16 14" />
                            </svg>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value" id="stat-avg-time">0s</span>
                            <span class="stat-label">平均耗时</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>成功率</h3>
                    </div>
                    <div class="progress-section">
                        <div class="progress-bar">
                            <div id="success-rate-bar" class="progress-fill" style="width: 0%"></div>
                        </div>
                        <span id="success-rate-text" class="progress-text">0%</span>
                    </div>
                </div>

                <div class="action-bar">
                    <button id="btn-reset-stats" class="btn btn-text">重置统计</button>
                </div>
            </section>
        </main>

        <!-- 配置编辑对话框 -->
        <div id="config-dialog" class="dialog-overlay hidden">
            <div class="dialog">
                <div class="dialog-header">
                    <h3 id="dialog-title">添加配置</h3>
                    <button id="btn-close-dialog" class="icon-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18" />
                            <line x1="6" y1="6" x2="18" y2="18" />
                        </svg>
                    </button>
                </div>
                <div class="dialog-content">
                    <form id="config-form">
                        <input type="hidden" id="config-id">

                        <div class="form-group">
                            <label for="config-name">配置名称 *</label>
                            <input type="text" id="config-name" required placeholder="例如: 我的OpenAI配置">
                        </div>

                        <div class="form-group">
                            <label for="config-type">API类型 *</label>
                            <select id="config-type" required>
                                <option value="openai_compatible">OpenAI 兼容</option>
                                <option value="claude">Claude/Anthropic</option>
                                <option value="gemini">Google Gemini</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="config-base-url">API 地址 *</label>
                            <input type="url" id="config-base-url" required placeholder="https://api.openai.com/v1">
                            <span class="hint">API的基础URL地址</span>
                        </div>

                        <div class="form-group">
                            <label for="config-api-key">API 密钥 *</label>
                            <div class="input-with-btn">
                                <input type="password" id="config-api-key" required placeholder="sk-xxx...">
                                <button type="button" id="btn-toggle-key" class="icon-btn">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                                        <circle cx="12" cy="12" r="3" />
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="config-model">模型名称 *</label>
                            <input type="text" id="config-model" required placeholder="gpt-4o">
                            <span class="hint">要使用的模型名称</span>
                        </div>

                        <details class="advanced-settings">
                            <summary>高级设置</summary>
                            <div class="advanced-content">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="config-max-tokens">最大Token数</label>
                                        <input type="number" id="config-max-tokens" min="10" max="500" value="100">
                                    </div>
                                    <div class="form-group">
                                        <label for="config-temperature">Temperature</label>
                                        <input type="number" id="config-temperature" min="0" max="2" step="0.1"
                                            value="0.1">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="config-custom-prompt">自定义识别Prompt</label>
                                    <textarea id="config-custom-prompt" rows="4"
                                        placeholder="留空使用默认Prompt..."></textarea>
                                </div>
                            </div>
                        </details>
                    </form>
                </div>
                <div class="dialog-footer">
                    <button id="btn-test-connection" class="btn btn-secondary">测试连接</button>
                    <button id="btn-save-config" class="btn btn-primary">保存</button>
                </div>
            </div>
        </div>

        <!-- Toast提示 -->
        <div id="toast" class="toast hidden">
            <span id="toast-message"></span>
        </div>
    </div>

    <script src="options.js" type="module"></script>
</body>

</html>